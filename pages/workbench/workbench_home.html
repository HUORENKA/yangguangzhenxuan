<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>工作台首页 | 阳光优采</title>
  
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- FontAwesome CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  
  <!-- 自定义样式 -->
  <link rel="stylesheet" href="../../assets/custom.css">
  
  <style>
    /* Tailwind 配置扩展 */
    @layer utilities {
      .text-primary { color: #E2231A; }
      .bg-primary { background-color: #E2231A; }
      .border-primary { border-color: #E2231A; }
    }
    
    /* 模块卡片样式 */
    .module-card {
      background: linear-gradient(135deg, #ffffff 0%, #fafbfc 100%);
      border: 1px solid rgba(0,0,0,0.04);
      transition: all 0.3s ease;
    }
    
    .module-card:hover {
      box-shadow: 0 8px 25px rgba(0,0,0,0.08);
      transform: translateY(-2px);
    }
    
    /* 模块标题图标样式 */
    .module-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
    }
    
    /* 数据行样式 */
    .data-row {
      transition: all 0.25s ease;
      border: 1px solid transparent;
    }
    
    .data-row:hover {
      transform: translateX(4px);
      border-color: rgba(0,0,0,0.08);
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }
    
    /* 消息列表项样式 */
    .message-item {
      transition: all 0.25s ease;
      border-left: 3px solid transparent;
    }
    
    .message-item:hover {
      background-color: #f8fafc;
      border-left-color: #E2231A;
      transform: translateX(2px);
    }
    
    /* 消息列表滚动容器 - 固定显示5条消息 */
    .message-scroll-container {
      max-height: 210px;
      overflow-y: auto;
    }
    
    /* 产品卡片16:9图片容器 */
    .product-img-16-9 {
      aspect-ratio: 16 / 9;
      width: 100%;
      object-fit: cover;
    }
    
    /* 产品卡片缩小图片样式 */
    .product-img-small {
      aspect-ratio: 16 / 9;
      width: 100%;
      height: 80px;
      object-fit: cover;
    }
    
    /* 下架商品遮罩层 */
    .product-disabled-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 0.5rem 0.5rem 0 0;
    }
    
    .product-disabled-badge {
      background: rgba(107, 114, 128, 0.9);
      color: white;
      padding: 4px 12px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    /* 查看更多卡片样式 */
    .view-more-card {
      border: 2px dashed #cbd5e1;
      background: #f8fafc;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 130px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .view-more-card:hover {
      border-color: #E2231A;
      background: #fff5f5;
    }
    
    /* 自定义滚动条 */
    .message-scroll-container::-webkit-scrollbar {
      width: 6px;
    }
    
    .message-scroll-container::-webkit-scrollbar-track {
      background: #f1f5f9;
      border-radius: 3px;
    }
    
    .message-scroll-container::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 3px;
    }
    
    .message-scroll-container::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }
    
    /* 商品卡片样式 */
    .product-card {
      transition: all 0.3s ease;
      border: 1px solid #e5e7eb;
    }
    
    .product-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.12);
      border-color: #E2231A;
    }
    
    .product-card:hover .product-img-16-9 {
      transform: scale(1.05);
    }
    
    .product-card .relative {
      overflow: hidden;
    }
    
    .product-card .product-img-16-9 {
      transition: transform 0.3s ease;
    }
    
    /* 查看全部链接样式 */
    .view-all-link {
      transition: all 0.2s ease;
      padding: 4px 8px;
      border-radius: 4px;
    }
    
    .view-all-link:hover {
      background-color: rgba(226, 35, 26, 0.08);
      text-decoration: none !important;
    }
    
    /* 数字高亮动画 */
    .data-number {
      transition: all 0.2s ease;
    }
    
    .data-row:hover .data-number {
      transform: scale(1.1);
    }
    
    /* 消息标签样式 */
    .message-tag {
      font-weight: 600;
      letter-spacing: 0.02em;
    }
    
    /* 图表切换按钮样式 */
    .chart-toggle-btn {
      padding: 6px 12px;
      font-size: 13px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      font-weight: 500;
    }
    
    .chart-toggle-btn.active {
      background-color: #3b82f6;
      color: white;
    }
    
    .chart-toggle-btn.inactive {
      background-color: #e5e7eb;
      color: #4b5563;
    }
    
    .chart-toggle-btn.inactive:hover {
      background-color: #d1d5db;
    }
    
    /* 图表容器样式 */
    .chart-container {
      position: relative;
      height: 300px;
    }
    
    /* 重要待办卡片样式 */
    .todo-card {
      background: white;
      border-radius: 10px;
      padding: 12px 16px;
      border: 2px solid;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    
    .todo-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      width: 4px;
      background: currentColor;
      transform: scaleY(0);
      transition: transform 0.3s ease;
    }
    
    .todo-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
    }
    
    .todo-card:hover::before {
      transform: scaleY(1);
    }
    
    .todo-card-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      flex-shrink: 0;
      transition: transform 0.3s ease;
    }
    
    .todo-card:hover .todo-card-icon {
      transform: scale(1.1) rotate(5deg);
    }
    
    .todo-card-content {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
      min-width: 0;
    }
    
    .todo-card-label {
      font-size: 13px;
      font-weight: 500;
      color: #4b5563;
      line-height: 1.3;
      flex: 1;
      min-width: 0;
    }
    
    .todo-card-number {
      font-size: 24px;
      font-weight: 700;
      line-height: 1;
      flex-shrink: 0;
      margin-left: auto;
    }
  </style>
</head>
<body class="bg-gray-100">
  
  <!-- 主容器 -->
  <div class="min-h-screen p-5 max-w-[1920px] mx-auto">
    
    <!-- 页面头部 -->
    <div class="mb-5">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-4">
          <div class="w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-xl flex items-center justify-center shadow-lg">
            <i class="fas fa-briefcase text-white text-xl"></i>
          </div>
          <div>
            <h1 class="text-2xl font-bold text-gray-900">工作台</h1>
            <p class="text-sm text-gray-500 mt-0.5">您的工作中心，快速处理待办事项</p>
          </div>
        </div>
        <!-- 角色切换下拉框 -->
        <div class="flex items-center gap-2 mr-4">
          <label class="text-sm text-gray-600 whitespace-nowrap">角色：</label>
          <select 
            id="roleSelector" 
            class="px-3 py-1.5 border border-gray-300 rounded text-sm bg-white hover:border-primary focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-all cursor-pointer"
            onchange="switchRole(this.value)"
          >
            <option value="buyer">采购专员</option>
            <option value="supplier">供应商</option>
          </select>
          <span id="roleHint" class="text-xs text-gray-500 max-w-[180px]">采购专员可审批采购单、跟进订单和售后</span>
        </div>
        
        <!-- 用户信息 -->
        <div class="flex items-center gap-3 bg-white px-4 py-2 rounded-lg shadow-sm">
          <div class="w-9 h-9 bg-gradient-to-br from-blue-400 to-blue-500 rounded-full flex items-center justify-center">
            <i class="fas fa-user text-white text-sm"></i>
          </div>
          <span class="text-sm font-medium text-gray-700" id="userName">张三（采购专员）</span>
        </div>
      </div>
    </div>
    
    <!-- 内容区域 -->
    
    <!-- ==================== 重要待办行 ==================== -->
    <div class="module-card rounded-xl shadow-sm p-5 mb-5">
      <div class="flex items-center justify-between mb-4">
        <div class="flex items-center gap-3">
          <div class="module-icon bg-gradient-to-br from-yellow-500 to-orange-500 text-white shadow-sm">
            <i class="fas fa-tasks"></i>
          </div>
          <h2 class="text-xl font-bold text-gray-800">重要待办</h2>
        </div>
      </div>
      
      <!-- 供应商角色待办（6个指标） -->
      <div id="supplierTodos" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3" style="display: none;">
        <div class="todo-card border-blue-200 text-blue-600" onclick="navigateTo('po-list')">
          <div class="todo-card-content">
            <div class="todo-card-icon bg-blue-100 text-blue-600">
              <i class="fas fa-file-invoice"></i>
            </div>
            <div class="todo-card-label">待确认采购单</div>
          </div>
          <div class="todo-card-number text-blue-600" id="supplierTodo1">12</div>
        </div>
        <div class="todo-card border-blue-200 text-blue-600" onclick="navigateTo('orders-list?status=pending')">
          <div class="todo-card-content">
            <div class="todo-card-icon bg-blue-100 text-blue-600">
              <i class="fas fa-hourglass-half"></i>
            </div>
            <div class="todo-card-label">待确认订单</div>
          </div>
          <div class="todo-card-number text-blue-600" id="supplierTodo2">8</div>
        </div>
        <div class="todo-card border-orange-200 text-orange-600" onclick="navigateTo('orders-list?status=shipping')">
          <div class="todo-card-content">
            <div class="todo-card-icon bg-orange-100 text-orange-600">
              <i class="fas fa-truck-loading"></i>
            </div>
            <div class="todo-card-label">待发货订单</div>
          </div>
          <div class="todo-card-number text-orange-600" id="supplierTodo3">12</div>
        </div>
        <div class="todo-card border-yellow-200 text-yellow-600" onclick="window.location.href='after_sales/after_sales_supplier.html?tab=pending'">
          <div class="todo-card-content">
            <div class="todo-card-icon bg-yellow-100 text-yellow-600">
              <i class="fas fa-question-circle"></i>
            </div>
            <div class="todo-card-label">退货待确认</div>
          </div>
          <div class="todo-card-number text-yellow-600" id="supplierTodo4">3</div>
        </div>
        <div class="todo-card border-gray-200 text-gray-600" onclick="navigateTo('contract-list?status=pending')">
          <div class="todo-card-content">
            <div class="todo-card-icon bg-gray-100 text-gray-600">
              <i class="fas fa-file-signature"></i>
            </div>
            <div class="todo-card-label">待提交合同</div>
          </div>
          <div class="todo-card-number text-gray-600" id="supplierTodo5">6</div>
        </div>
        <div class="todo-card border-orange-200 text-orange-600" onclick="navigateTo('settlement-list?status=invoice')">
          <div class="todo-card-content">
            <div class="todo-card-icon bg-orange-100 text-orange-600">
              <i class="fas fa-receipt"></i>
            </div>
            <div class="todo-card-label">待开票</div>
          </div>
          <div class="todo-card-number text-orange-600" id="supplierTodo6">8</div>
        </div>
      </div>
      
      <!-- 采购专员角色待办（5个指标） -->
      <div id="buyerTodos" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3">
        <div class="todo-card border-blue-200 text-blue-600" onclick="navigateTo('po-list?tab=my-audit')">
          <div class="todo-card-content">
            <div class="todo-card-icon bg-blue-100 text-blue-600">
              <i class="fas fa-user-check"></i>
            </div>
            <div class="todo-card-label">待我审核采购单</div>
          </div>
          <div class="todo-card-number text-blue-600" id="buyerTodo1">10</div>
        </div>
        <div class="todo-card border-green-200 text-green-600" onclick="navigateTo('orders-list?status=receiving')">
          <div class="todo-card-content">
            <div class="todo-card-icon bg-green-100 text-green-600">
              <i class="fas fa-truck"></i>
            </div>
            <div class="todo-card-label">待收货</div>
          </div>
          <div class="todo-card-number text-green-600" id="buyerTodo2">15</div>
        </div>
        <div class="todo-card border-orange-200 text-orange-600" onclick="window.location.href='after_sales/after_sales_buyer.html?tab=return'">
          <div class="todo-card-content">
            <div class="todo-card-icon bg-orange-100 text-orange-600">
              <i class="fas fa-box-open"></i>
            </div>
            <div class="todo-card-label">待退货</div>
          </div>
          <div class="todo-card-number text-orange-600" id="buyerTodo3">2</div>
        </div>
        <div class="todo-card border-blue-200 text-blue-600" onclick="navigateTo('contract-list?status=approving')">
          <div class="todo-card-content">
            <div class="todo-card-icon bg-blue-100 text-blue-600">
              <i class="fas fa-file-signature"></i>
            </div>
            <div class="todo-card-label">待审核合同</div>
          </div>
          <div class="todo-card-number text-blue-600" id="buyerTodo4">9</div>
        </div>
        <div class="todo-card border-purple-200 text-purple-600" onclick="navigateTo('settlement-list?status=payment')">
          <div class="todo-card-content">
            <div class="todo-card-icon bg-purple-100 text-purple-600">
              <i class="fas fa-credit-card"></i>
            </div>
            <div class="todo-card-label">待付款</div>
          </div>
          <div class="todo-card-number text-purple-600" id="buyerTodo5">5</div>
        </div>
      </div>
    </div>
    
    <!-- ==================== 图表行：折线图 + 饼状图 ==================== -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-5 mb-5">
      
      <!-- 折线图模块（占2/3宽度） -->
      <div class="lg:col-span-2 module-card rounded-xl shadow-sm p-5">
        <div class="flex items-center justify-between mb-4">
          <!-- 左侧：标题 + 总量/增量切换 -->
          <div class="flex items-center gap-4">
            <h3 class="text-lg font-bold text-gray-800">订单数量趋势</h3>
            <div class="flex items-center gap-2">
              <button id="lineChartTypeTotal" class="chart-toggle-btn active" onclick="switchLineChartType('total')">
                总量
              </button>
              <button id="lineChartTypeIncrement" class="chart-toggle-btn inactive" onclick="switchLineChartType('increment')">
                增量
              </button>
            </div>
          </div>
          
          <!-- 右上角：时间维度切换 -->
          <div class="flex items-center gap-2">
            <button id="lineChartPeriodDay" class="chart-toggle-btn active" onclick="switchLineChartPeriod('day')">
              日
            </button>
            <button id="lineChartPeriodWeek" class="chart-toggle-btn inactive" onclick="switchLineChartPeriod('week')">
              周
            </button>
            <button id="lineChartPeriodMonth" class="chart-toggle-btn inactive" onclick="switchLineChartPeriod('month')">
              月
            </button>
          </div>
        </div>
        
        <!-- 折线图容器 -->
        <div class="chart-container">
          <canvas id="lineChart"></canvas>
        </div>
      </div>
      
      <!-- 饼状图模块（占1/3宽度） -->
      <div class="lg:col-span-1 module-card rounded-xl shadow-sm p-5">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-bold text-gray-800">订单状态分布</h3>
          
          <!-- 右上角：时间维度切换 -->
          <div class="flex items-center gap-1.5 flex-wrap">
            <button id="pieChartPeriodMonth" class="chart-toggle-btn active text-xs px-2 py-1" onclick="switchPieChartPeriod('month')">
              近一个月
            </button>
            <button id="pieChartPeriodYear" class="chart-toggle-btn inactive text-xs px-2 py-1" onclick="switchPieChartPeriod('year')">
              近一年
            </button>
            <button id="pieChartPeriodAll" class="chart-toggle-btn inactive text-xs px-2 py-1" onclick="switchPieChartPeriod('all')">
              全部
            </button>
          </div>
        </div>
        
        <!-- 饼状图容器 -->
        <div class="chart-container">
          <canvas id="pieChart"></canvas>
        </div>
      </div>
      
    </div>
    
    <!-- ==================== 第一行：我的消息 + 采购单 + 订单管理 ==================== -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-5 mb-5">
      
      <!-- 我的消息 -->
      <div class="module-card rounded-xl shadow-sm p-5 flex flex-col" style="min-height: 260px;">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="module-icon bg-gradient-to-br from-red-500 to-red-600 text-white shadow-sm">
              <i class="fas fa-bell"></i>
            </div>
            <h2 class="text-lg font-bold text-gray-800">我的消息</h2>
          </div>
          <a href="#" class="view-all-link text-sm text-primary font-medium">查看全部 <i class="fas fa-chevron-right text-xs ml-1"></i></a>
        </div>
        
        <!-- 消息列表（可滚动，10条记录，显示5条） -->
        <div class="message-scroll-container space-y-0 border-t border-gray-100 flex-1 pt-2">
          <div class="message-item flex items-center justify-between py-2.5 px-3 cursor-pointer rounded-r">
            <div class="flex items-center gap-3 flex-1 min-w-0">
              <span class="message-tag px-2 py-1 text-xs bg-orange-100 text-orange-700 rounded-md whitespace-nowrap">采购单审核</span>
              <span class="text-sm text-gray-700 truncate">商城订单采购审核流程</span>
            </div>
            <span class="text-xs text-gray-400 whitespace-nowrap ml-3">01-18</span>
          </div>
          <div class="message-item flex items-center justify-between py-2.5 px-3 cursor-pointer rounded-r">
            <div class="flex items-center gap-3 flex-1 min-w-0">
              <span class="message-tag px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-md whitespace-nowrap">订单通知</span>
              <span class="text-sm text-gray-700 truncate">订单ORD20260117已确认收货</span>
            </div>
            <span class="text-xs text-gray-400 whitespace-nowrap ml-3">01-17</span>
          </div>
          <div class="message-item flex items-center justify-between py-2.5 px-3 cursor-pointer rounded-r">
            <div class="flex items-center gap-3 flex-1 min-w-0">
              <span class="message-tag px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded-md whitespace-nowrap">合同签署</span>
              <span class="text-sm text-gray-700 truncate">合同HT2026015已审批通过</span>
            </div>
            <span class="text-xs text-gray-400 whitespace-nowrap ml-3">01-15</span>
          </div>
          <div class="message-item flex items-center justify-between py-2.5 px-3 cursor-pointer rounded-r">
            <div class="flex items-center gap-3 flex-1 min-w-0">
              <span class="message-tag px-2 py-1 text-xs bg-orange-100 text-orange-700 rounded-md whitespace-nowrap">采购单审核</span>
              <span class="text-sm text-gray-700 truncate">采购单PO20260114待您审核</span>
            </div>
            <span class="text-xs text-gray-400 whitespace-nowrap ml-3">01-14</span>
          </div>
          <div class="message-item flex items-center justify-between py-2.5 px-3 cursor-pointer rounded-r">
            <div class="flex items-center gap-3 flex-1 min-w-0">
              <span class="message-tag px-2 py-1 text-xs bg-green-100 text-green-700 rounded-md whitespace-nowrap">系统消息</span>
              <span class="text-sm text-gray-700 truncate">您的账户安全验证已更新</span>
            </div>
            <span class="text-xs text-gray-400 whitespace-nowrap ml-3">01-12</span>
          </div>
          <div class="message-item flex items-center justify-between py-2.5 px-3 cursor-pointer rounded-r">
            <div class="flex items-center gap-3 flex-1 min-w-0">
              <span class="message-tag px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-md whitespace-nowrap">订单通知</span>
              <span class="text-sm text-gray-700 truncate">您的订单ORD20260110已发货</span>
            </div>
            <span class="text-xs text-gray-400 whitespace-nowrap ml-3">01-10</span>
          </div>
          <div class="message-item flex items-center justify-between py-2.5 px-3 cursor-pointer rounded-r">
            <div class="flex items-center gap-3 flex-1 min-w-0">
              <span class="message-tag px-2 py-1 text-xs bg-red-100 text-red-700 rounded-md whitespace-nowrap">售后通知</span>
              <span class="text-sm text-gray-700 truncate">售后申请SH20260108已受理</span>
            </div>
            <span class="text-xs text-gray-400 whitespace-nowrap ml-3">01-08</span>
          </div>
          <div class="message-item flex items-center justify-between py-2.5 px-3 cursor-pointer rounded-r">
            <div class="flex items-center gap-3 flex-1 min-w-0">
              <span class="message-tag px-2 py-1 text-xs bg-teal-100 text-teal-700 rounded-md whitespace-nowrap">结算通知</span>
              <span class="text-sm text-gray-700 truncate">结算单JS20260105已完成付款</span>
            </div>
            <span class="text-xs text-gray-400 whitespace-nowrap ml-3">01-05</span>
          </div>
          <div class="message-item flex items-center justify-between py-2.5 px-3 cursor-pointer rounded-r">
            <div class="flex items-center gap-3 flex-1 min-w-0">
              <span class="message-tag px-2 py-1 text-xs bg-orange-100 text-orange-700 rounded-md whitespace-nowrap">采购单审核</span>
              <span class="text-sm text-gray-700 truncate">采购单PO20260103审核不通过</span>
            </div>
            <span class="text-xs text-gray-400 whitespace-nowrap ml-3">01-03</span>
          </div>
          <div class="message-item flex items-center justify-between py-2.5 px-3 cursor-pointer rounded-r">
            <div class="flex items-center gap-3 flex-1 min-w-0">
              <span class="message-tag px-2 py-1 text-xs bg-green-100 text-green-700 rounded-md whitespace-nowrap">系统消息</span>
              <span class="text-sm text-gray-700 truncate">新年快乐！感谢您的支持</span>
            </div>
            <span class="text-xs text-gray-400 whitespace-nowrap ml-3">01-01</span>
          </div>
        </div>
      </div>
      
      <!-- 采购单 -->
      <div id="poModule" class="module-card rounded-xl shadow-sm p-5 cursor-pointer flex flex-col" style="min-height: 260px;" onclick="navigateTo('po-list')">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="module-icon bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-sm">
              <i class="fas fa-file-invoice"></i>
            </div>
            <h3 class="text-lg font-bold text-gray-800">采购单</h3>
          </div>
          <a href="#" class="view-all-link text-sm text-primary font-medium" onclick="event.stopPropagation()">查看全部 <i class="fas fa-chevron-right text-xs ml-1"></i></a>
        </div>
        <div class="space-y-2.5 flex-1 flex flex-col justify-center">
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-blue-50 rounded-lg cursor-pointer" onclick="event.stopPropagation(); navigateTo('po-my-audit')">
            <div class="flex items-center gap-2">
              <i class="fas fa-user-check text-blue-500 text-sm"></i>
              <span id="poMyAuditLabel" class="text-sm font-medium text-gray-700">我的审核</span>
            </div>
            <span class="data-number text-lg font-bold text-blue-600" id="poMyAudit">10<span class="text-sm text-gray-400 font-normal">/20</span></span>
          </div>
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-orange-50 rounded-lg cursor-pointer" onclick="event.stopPropagation(); navigateTo('po-pending')">
            <div class="flex items-center gap-2">
              <i class="fas fa-clock text-orange-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">待审核</span>
            </div>
            <span class="data-number text-lg font-bold text-orange-600" id="poPending">5</span>
          </div>
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-green-50 rounded-lg cursor-pointer" onclick="event.stopPropagation(); navigateTo('po-approved')">
            <div class="flex items-center gap-2">
              <i class="fas fa-check-circle text-green-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">审核通过</span>
            </div>
            <span class="data-number text-lg font-bold text-green-600" id="poApproved">28</span>
          </div>
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-red-50 rounded-lg cursor-pointer" onclick="event.stopPropagation(); navigateTo('po-rejected')">
            <div class="flex items-center gap-2">
              <i class="fas fa-times-circle text-red-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">审核不通过</span>
            </div>
            <span class="data-number text-lg font-bold text-red-600" id="poRejected">3</span>
          </div>
        </div>
      </div>
      
      <!-- 订单管理 -->
      <div class="module-card rounded-xl shadow-sm p-5 flex flex-col" style="min-height: 260px;">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="module-icon bg-gradient-to-br from-green-500 to-green-600 text-white shadow-sm">
              <i class="fas fa-shopping-bag"></i>
            </div>
            <h3 class="text-lg font-bold text-gray-800">订单管理</h3>
          </div>
          <a href="#" class="view-all-link text-sm text-primary font-medium">查看全部 <i class="fas fa-chevron-right text-xs ml-1"></i></a>
        </div>
        <div class="space-y-2.5 flex-1 flex flex-col justify-center">
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-blue-50 rounded-lg cursor-pointer">
            <div class="flex items-center gap-2">
              <i class="fas fa-hourglass-half text-blue-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">待供应商确认</span>
            </div>
            <span class="data-number text-lg font-bold text-blue-600" id="orderPending">8</span>
          </div>
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-orange-50 rounded-lg cursor-pointer">
            <div class="flex items-center gap-2">
              <i class="fas fa-truck-loading text-orange-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">待发货</span>
            </div>
            <span class="data-number text-lg font-bold text-orange-600" id="orderShipping">12</span>
          </div>
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-green-50 rounded-lg cursor-pointer">
            <div class="flex items-center gap-2">
              <i class="fas fa-truck text-green-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">待收货</span>
            </div>
            <span class="data-number text-lg font-bold text-green-600" id="orderReceiving">15</span>
          </div>
          <!-- 最后一行：收货完成 | 已取消 -->
          <div class="grid grid-cols-2 gap-2">
            <div class="data-row flex items-center justify-between py-2.5 px-3 bg-teal-50 rounded-lg cursor-pointer">
              <div class="flex items-center gap-2">
                <i class="fas fa-box-check text-teal-500 text-xs"></i>
                <span class="text-sm font-medium text-gray-700">收货完成</span>
              </div>
              <span class="data-number text-lg font-bold text-teal-600" id="orderCompleted">56</span>
            </div>
            <div class="data-row flex items-center justify-between py-2.5 px-3 bg-gray-100 rounded-lg cursor-pointer">
              <div class="flex items-center gap-2">
                <i class="fas fa-ban text-gray-400 text-xs"></i>
                <span class="text-sm font-medium text-gray-600">已取消</span>
              </div>
              <span class="data-number text-lg font-bold text-gray-500" id="orderCancelled">3</span>
            </div>
          </div>
        </div>
      </div>
      
    </div>
    
    <!-- ==================== 第二行：售后管理 + 合同签署 + 结算订单 ==================== -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-5 mb-5">
      
      <!-- 售后管理 -->
      <div class="module-card rounded-xl shadow-sm p-5 cursor-pointer" onclick="window.location.href='after_sales/after_sales_buyer.html'">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="module-icon bg-gradient-to-br from-purple-500 to-purple-600 text-white shadow-sm">
              <i class="fas fa-undo"></i>
            </div>
            <h3 class="text-lg font-bold text-gray-800">售后管理</h3>
          </div>
          <a href="after_sales/after_sales_buyer.html" class="view-all-link text-sm text-primary font-medium" onclick="event.stopPropagation()">查看全部 <i class="fas fa-chevron-right text-xs ml-1"></i></a>
        </div>
        <div class="space-y-2.5">
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-yellow-50 rounded-lg cursor-pointer" onclick="event.stopPropagation(); window.location.href='after_sales/after_sales_buyer.html?tab=pending'">
            <div class="flex items-center gap-2">
              <i class="fas fa-question-circle text-yellow-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">待确认</span>
            </div>
            <span class="data-number text-lg font-bold text-yellow-600" id="afterSaleConfirm">3</span>
          </div>
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-orange-50 rounded-lg cursor-pointer" onclick="event.stopPropagation(); window.location.href='after_sales/after_sales_buyer.html?tab=return'">
            <div class="flex items-center gap-2">
              <i class="fas fa-box-open text-orange-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">待退货</span>
            </div>
            <span class="data-number text-lg font-bold text-orange-600" id="afterSaleReturn">2</span>
          </div>
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-blue-50 rounded-lg cursor-pointer" onclick="event.stopPropagation(); window.location.href='after_sales/after_sales_buyer.html?tab=shipping'">
            <div class="flex items-center gap-2">
              <i class="fas fa-shipping-fast text-blue-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">退货中</span>
            </div>
            <span class="data-number text-lg font-bold text-blue-600" id="afterSaleReturning">4</span>
          </div>
          <!-- 最后一行：退货完成 | 已取消 -->
          <div class="grid grid-cols-2 gap-2">
            <div class="data-row flex items-center justify-between py-2.5 px-3 bg-green-50 rounded-lg cursor-pointer" onclick="event.stopPropagation(); window.location.href='after_sales/after_sales_buyer.html?tab=completed'">
              <div class="flex items-center gap-2">
                <i class="fas fa-check-double text-green-500 text-xs"></i>
                <span class="text-sm font-medium text-gray-700">退货完成</span>
              </div>
              <span class="data-number text-lg font-bold text-green-600" id="afterSaleCompleted">18</span>
            </div>
            <div class="data-row flex items-center justify-between py-2.5 px-3 bg-gray-100 rounded-lg cursor-pointer" onclick="event.stopPropagation(); window.location.href='after_sales/after_sales_buyer.html?tab=cancelled'">
              <div class="flex items-center gap-2">
                <i class="fas fa-ban text-gray-400 text-xs"></i>
                <span class="text-sm font-medium text-gray-600">已取消</span>
              </div>
              <span class="data-number text-lg font-bold text-gray-500" id="afterSaleCancelled">5</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 合同签署 -->
      <div class="module-card rounded-xl shadow-sm p-5">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="module-icon bg-gradient-to-br from-indigo-500 to-indigo-600 text-white shadow-sm">
              <i class="fas fa-file-signature"></i>
            </div>
            <h3 class="text-lg font-bold text-gray-800">合同签署</h3>
          </div>
          <a href="#" class="view-all-link text-sm text-primary font-medium">查看全部 <i class="fas fa-chevron-right text-xs ml-1"></i></a>
        </div>
        <div class="space-y-2.5">
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-gray-100 rounded-lg cursor-pointer">
            <div class="flex items-center gap-2">
              <i class="fas fa-edit text-gray-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">待提交</span>
            </div>
            <span class="data-number text-lg font-bold text-gray-600" id="contractSubmit">6</span>
          </div>
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-blue-50 rounded-lg cursor-pointer">
            <div class="flex items-center gap-2">
              <i class="fas fa-spinner text-blue-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">审批中</span>
            </div>
            <span class="data-number text-lg font-bold text-blue-600" id="contractApproving">9</span>
          </div>
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-red-50 rounded-lg cursor-pointer">
            <div class="flex items-center gap-2">
              <i class="fas fa-reply text-red-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">退回</span>
            </div>
            <span class="data-number text-lg font-bold text-red-600" id="contractRejected">1</span>
          </div>
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-green-50 rounded-lg cursor-pointer">
            <div class="flex items-center gap-2">
              <i class="fas fa-check-circle text-green-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">通过</span>
            </div>
            <span class="data-number text-lg font-bold text-green-600" id="contractApproved">24</span>
          </div>
        </div>
      </div>
      
      <!-- 结算订单 -->
      <div class="module-card rounded-xl shadow-sm p-5">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="module-icon bg-gradient-to-br from-teal-500 to-teal-600 text-white shadow-sm">
              <i class="fas fa-calculator"></i>
            </div>
            <h3 class="text-lg font-bold text-gray-800">结算订单</h3>
          </div>
          <a href="#" class="view-all-link text-sm text-primary font-medium">查看全部 <i class="fas fa-chevron-right text-xs ml-1"></i></a>
        </div>
        <div class="space-y-2.5">
          <!-- 第一行：待提交 -->
          <div class="data-row flex items-center justify-between py-2.5 px-4 bg-yellow-50 rounded-lg cursor-pointer">
            <div class="flex items-center gap-2">
              <i class="fas fa-paper-plane text-yellow-500 text-sm"></i>
              <span class="text-sm font-medium text-gray-700">待提交</span>
            </div>
            <span class="data-number text-lg font-bold text-yellow-600" id="settlementSubmit">7</span>
          </div>
          <!-- 第二行：编辑中 | 待核对 -->
          <div class="grid grid-cols-2 gap-2">
            <div class="data-row flex items-center justify-between py-2.5 px-3 bg-gray-100 rounded-lg cursor-pointer">
              <div class="flex items-center gap-2">
                <i class="fas fa-pencil-alt text-gray-500 text-xs"></i>
                <span class="text-sm font-medium text-gray-700">编辑中</span>
              </div>
              <span class="data-number text-lg font-bold text-gray-600" id="settlementEditing">4</span>
            </div>
            <div class="data-row flex items-center justify-between py-2.5 px-3 bg-blue-50 rounded-lg cursor-pointer">
              <div class="flex items-center gap-2">
                <i class="fas fa-search text-blue-500 text-xs"></i>
                <span class="text-sm font-medium text-gray-700">待核对</span>
              </div>
              <span class="data-number text-lg font-bold text-blue-600" id="settlementChecking">6</span>
            </div>
          </div>
          <!-- 第三行：待开票 | 待付款 -->
          <div class="grid grid-cols-2 gap-2">
            <div class="data-row flex items-center justify-between py-2.5 px-3 bg-orange-50 rounded-lg cursor-pointer">
              <div class="flex items-center gap-2">
                <i class="fas fa-receipt text-orange-500 text-xs"></i>
                <span class="text-sm font-medium text-gray-700">待开票</span>
              </div>
              <span class="data-number text-lg font-bold text-orange-600" id="settlementInvoice">8</span>
            </div>
            <div class="data-row flex items-center justify-between py-2.5 px-3 bg-purple-50 rounded-lg cursor-pointer">
              <div class="flex items-center gap-2">
                <i class="fas fa-credit-card text-purple-500 text-xs"></i>
                <span class="text-sm font-medium text-gray-700">待付款</span>
              </div>
              <span class="data-number text-lg font-bold text-purple-600" id="settlementPayment">5</span>
            </div>
          </div>
          <!-- 第四行：待收款 | 结算完成 -->
          <div class="grid grid-cols-2 gap-2">
            <div class="data-row flex items-center justify-between py-2.5 px-3 bg-indigo-50 rounded-lg cursor-pointer">
              <div class="flex items-center gap-2">
                <i class="fas fa-hand-holding-usd text-indigo-500 text-xs"></i>
                <span class="text-sm font-medium text-gray-700">待收款</span>
              </div>
              <span class="data-number text-lg font-bold text-indigo-600" id="settlementReceiving">3</span>
            </div>
            <div class="data-row flex items-center justify-between py-2.5 px-3 bg-green-50 rounded-lg cursor-pointer">
              <div class="flex items-center gap-2">
                <i class="fas fa-check-double text-green-500 text-xs"></i>
                <span class="text-sm font-medium text-gray-700">结算完成</span>
              </div>
              <span class="data-number text-lg font-bold text-green-600" id="settlementCompleted">42</span>
            </div>
          </div>
        </div>
      </div>
      
    </div>
    
    <!-- ==================== 第三行：我的收藏（占满一行） ==================== -->
    <div class="module-card rounded-xl shadow-sm p-4 mb-5">
      <div class="flex items-center justify-between mb-3">
        <div class="flex items-center gap-3">
          <div class="module-icon bg-gradient-to-br from-red-500 to-pink-500 text-white shadow-sm">
            <i class="fas fa-heart"></i>
          </div>
          <h2 class="text-lg font-bold text-gray-800">我的收藏</h2>
        </div>
        <a href="#" class="view-all-link text-sm text-primary font-medium">管理收藏 <i class="fas fa-chevron-right text-xs ml-1"></i></a>
      </div>
          
      <!-- 商品网格（8列布局，占满整行） -->
      <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-2">
          
          <!-- 商品1：A4纸（正常） -->
          <div class="product-card bg-white rounded-lg overflow-hidden cursor-pointer">
            <div class="relative">
              <img src="https://images.unsplash.com/photo-1586075010923-2dd4570fb338?w=320&h=180&fit=crop" alt="A4纸" class="product-img-small">
              <button class="absolute top-1 right-1 w-5 h-5 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white shadow-sm transition-all">
                <i class="fas fa-heart text-primary text-xs"></i>
              </button>
            </div>
            <div class="p-1.5">
              <h3 class="text-xs font-medium text-gray-800 mb-0.5 line-clamp-1">得力A4复印纸</h3>
              <span class="text-xs font-bold text-primary">¥28.50</span>
            </div>
          </div>
          
          <!-- 商品2：打印机（下架） -->
          <div class="product-card bg-white rounded-lg overflow-hidden cursor-pointer opacity-75">
            <div class="relative">
              <img src="https://images.unsplash.com/photo-1612815154858-60aa4c59eaa6?w=320&h=180&fit=crop" alt="打印机" class="product-img-small">
              <div class="product-disabled-overlay">
                <div class="product-disabled-badge">
                  <i class="fas fa-ban text-xs"></i>
                  <span>已下架</span>
                </div>
              </div>
              <button class="absolute top-1 right-1 w-5 h-5 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white shadow-sm transition-all z-10">
                <i class="fas fa-heart text-gray-400 text-xs"></i>
              </button>
            </div>
            <div class="p-1.5">
              <h3 class="text-xs font-medium text-gray-500 mb-0.5 line-clamp-1">惠普一体机</h3>
              <span class="text-xs font-bold text-gray-400 line-through">¥1,299</span>
            </div>
          </div>
          
          <!-- 商品3：订书机（正常） -->
          <div class="product-card bg-white rounded-lg overflow-hidden cursor-pointer">
            <div class="relative">
              <img src="https://images.unsplash.com/photo-1583852096778-7bc43590f291?w=320&h=180&fit=crop" alt="订书机" class="product-img-small">
              <button class="absolute top-1 right-1 w-5 h-5 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white shadow-sm transition-all">
                <i class="fas fa-heart text-primary text-xs"></i>
              </button>
            </div>
            <div class="p-1.5">
              <h3 class="text-xs font-medium text-gray-800 mb-0.5 line-clamp-1">晨光订书机</h3>
              <span class="text-xs font-bold text-primary">¥12.80</span>
            </div>
          </div>
          
          <!-- 商品4：显示屏（正常） -->
          <div class="product-card bg-white rounded-lg overflow-hidden cursor-pointer">
            <div class="relative">
              <img src="https://images.unsplash.com/photo-1527443224154-c4a3942d3acf?w=320&h=180&fit=crop" alt="显示屏" class="product-img-small">
              <button class="absolute top-1 right-1 w-5 h-5 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white shadow-sm transition-all">
                <i class="fas fa-heart text-primary text-xs"></i>
              </button>
            </div>
            <div class="p-1.5">
              <h3 class="text-xs font-medium text-gray-800 mb-0.5 line-clamp-1">戴尔显示器</h3>
              <span class="text-xs font-bold text-primary">¥899</span>
            </div>
          </div>
          
          <!-- 商品5：键盘（正常） -->
          <div class="product-card bg-white rounded-lg overflow-hidden cursor-pointer">
            <div class="relative">
              <img src="https://images.unsplash.com/photo-1541140532154-b024d705b90a?w=320&h=180&fit=crop" alt="键盘" class="product-img-small">
              <button class="absolute top-1 right-1 w-5 h-5 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white shadow-sm transition-all">
                <i class="fas fa-heart text-primary text-xs"></i>
              </button>
            </div>
            <div class="p-1.5">
              <h3 class="text-xs font-medium text-gray-800 mb-0.5 line-clamp-1">机械键盘</h3>
              <span class="text-xs font-bold text-primary">¥299</span>
            </div>
          </div>
          
          <!-- 商品6：鼠标（下架） -->
          <div class="product-card bg-white rounded-lg overflow-hidden cursor-pointer opacity-75">
            <div class="relative">
              <img src="https://images.unsplash.com/photo-1527814050087-3793815479db?w=320&h=180&fit=crop" alt="鼠标" class="product-img-small">
              <div class="product-disabled-overlay">
                <div class="product-disabled-badge">
                  <i class="fas fa-ban text-xs"></i>
                  <span>已下架</span>
                </div>
              </div>
              <button class="absolute top-1 right-1 w-5 h-5 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white shadow-sm transition-all z-10">
                <i class="fas fa-heart text-gray-400 text-xs"></i>
              </button>
            </div>
            <div class="p-1.5">
              <h3 class="text-xs font-medium text-gray-500 mb-0.5 line-clamp-1">无线鼠标</h3>
              <span class="text-xs font-bold text-gray-400 line-through">¥89</span>
            </div>
          </div>
          
          <!-- 商品7：文件夹（正常） -->
          <div class="product-card bg-white rounded-lg overflow-hidden cursor-pointer">
            <div class="relative">
              <img src="https://images.unsplash.com/photo-1544396821-4dd40b938ad3?w=320&h=180&fit=crop" alt="文件夹" class="product-img-small">
              <button class="absolute top-1 right-1 w-5 h-5 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white shadow-sm transition-all">
                <i class="fas fa-heart text-primary text-xs"></i>
              </button>
            </div>
            <div class="p-1.5">
              <h3 class="text-xs font-medium text-gray-800 mb-0.5 line-clamp-1">A4文件夹</h3>
              <span class="text-xs font-bold text-primary">¥15.90</span>
            </div>
          </div>
          
          <!-- 查看更多卡片 -->
          <div class="view-more-card rounded-lg cursor-pointer" onclick="navigateTo('favorites')">
            <div class="flex flex-col items-center justify-center gap-2 py-2">
              <div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center">
                <i class="fas fa-chevron-right text-gray-400 text-lg"></i>
              </div>
              <span class="text-xs font-medium text-gray-600">查看更多</span>
            </div>
          </div>
          
      </div>
    </div>
    
    <!-- 页脚版权信息 -->
    <div class="mt-5 text-center text-sm text-gray-400">
      <p>© 2026 阳光优采采购平台 | 工作台原型演示</p>
    </div>
    
  </div>
  
  <!-- ==================== JavaScript ==================== -->
  <script>
    // ========== 角色名称映射 ==========
    const roleNameMap = {
      'buyer': '采购专员',
      'supplier': '供应商'
    };
    
    // ========== 权限说明映射 ==========
    const roleHintMap = {
      'buyer': '采购专员可审批采购单、跟进订单和售后',
      'supplier': '供应商可管理订单、售后和合同'
    };
    
    // ========== 用户名称映射 ==========
    const userNameMap = {
      'buyer': '张三（采购专员）',
      'supplier': '李四（供应商）'
    };
    
    // ========== 获取当前角色 ==========
    function getCurrentRole() {
      const role = localStorage.getItem('role') || 'buyer';
      // 只接受 buyer 或 supplier，其他值默认为 buyer
      if (role === 'supplier') return 'supplier';
      return 'buyer';
    }
    
    // ========== 切换角色 ==========
    function switchRole(newRole) {
      // 保存到 localStorage
      localStorage.setItem('role', newRole);
      
      // 更新权限说明
      updateRoleHint(newRole);
      
      // 更新用户名显示
      updateUserName(newRole);
      
      // 更新页面显示
      updatePageByRole(newRole);
      
      console.log('已切换到角色：', roleNameMap[newRole] || newRole);
    }
    
    // ========== 更新权限说明 ==========
    function updateRoleHint(role) {
      const hintElement = document.getElementById('roleHint');
      if (hintElement) {
        hintElement.textContent = roleHintMap[role] || '';
      }
    }
    
    // ========== 更新用户名显示 ==========
    function updateUserName(role) {
      const userNameElement = document.getElementById('userName');
      if (userNameElement) {
        userNameElement.textContent = userNameMap[role] || '用户';
      }
    }
    
    // ========== 根据角色更新页面 ==========
    function updatePageByRole(role) {
      // 更新页面标题
      const pageTitle = document.querySelector('h1.text-2xl');
      const pageDesc = document.querySelector('.text-sm.text-gray-500.mt-0\\.5');
      
      if (pageTitle) {
        if (role === 'supplier') {
          pageTitle.textContent = '供应商工作台';
        } else {
          pageTitle.textContent = '工作台';
        }
      }
      
      // 更新页面描述
      if (pageDesc) {
        if (role === 'supplier') {
          pageDesc.textContent = '管理订单、结算和售后，提升服务效率';
        } else {
          pageDesc.textContent = '您的工作中心，快速处理待办事项';
        }
      }
      
      // 更新页面图标
      const pageIcon = document.querySelector('.w-12.h-12 i');
      if (pageIcon) {
        if (role === 'supplier') {
          pageIcon.className = 'fas fa-store text-white text-xl';
        } else {
          pageIcon.className = 'fas fa-briefcase text-white text-xl';
        }
      }
      
      // 更新按钮显示/隐藏（使用 data-role 属性）
      const roleElements = document.querySelectorAll('[data-role]');
      roleElements.forEach(el => {
        const allowedRoles = el.getAttribute('data-role').split(',');
        if (allowedRoles.includes(role)) {
          el.style.display = '';
        } else {
          el.style.display = 'none';
        }
      });
      
      // 更新采购单模块标题（供应商和采购专员都显示"采购单"）
      const poModuleTitle = document.querySelector('#poModule h3');
      if (poModuleTitle) {
        poModuleTitle.textContent = '采购单';
      }
      
      // 更新"我的审核"文本（供应商显示"待确认采购单"，采购专员显示"我的审核"）
      const myAuditLabel = document.getElementById('poMyAuditLabel');
      if (myAuditLabel) {
        if (role === 'supplier') {
          myAuditLabel.textContent = '待确认采购单';
        } else {
          myAuditLabel.textContent = '我的审核';
        }
      }
      
      // 更新重要待办显示
      const supplierTodos = document.getElementById('supplierTodos');
      const buyerTodos = document.getElementById('buyerTodos');
      if (supplierTodos && buyerTodos) {
        if (role === 'supplier') {
          supplierTodos.style.display = 'grid';
          buyerTodos.style.display = 'none';
        } else {
          supplierTodos.style.display = 'none';
          buyerTodos.style.display = 'grid';
        }
      }
      
      // 同步重要待办数据
      updateTodosData(role);
      
      // 重新渲染折线图（因为角色变化会影响数据）
      renderLineChart();
    }
    
    // ========== 同步重要待办数据 ==========
    function updateTodosData(role) {
      if (role === 'supplier') {
        // 供应商：从现有模块同步数据
        const supplierTodo1 = document.getElementById('supplierTodo1'); // 待确认采购单
        const supplierTodo2 = document.getElementById('supplierTodo2'); // 待确认订单
        const supplierTodo3 = document.getElementById('supplierTodo3'); // 待发货订单
        const supplierTodo4 = document.getElementById('supplierTodo4'); // 退货待确认
        const supplierTodo5 = document.getElementById('supplierTodo5'); // 待提交合同
        const supplierTodo6 = document.getElementById('supplierTodo6'); // 待开票
        
        // 同步数据（从现有模块获取）
        if (supplierTodo1) supplierTodo1.textContent = document.getElementById('poMyAudit')?.textContent.split('/')[0] || '12';
        if (supplierTodo2) supplierTodo2.textContent = document.getElementById('orderPending')?.textContent || '8';
        if (supplierTodo3) supplierTodo3.textContent = document.getElementById('orderShipping')?.textContent || '12';
        if (supplierTodo4) supplierTodo4.textContent = document.getElementById('afterSaleConfirm')?.textContent || '3';
        if (supplierTodo5) supplierTodo5.textContent = document.getElementById('contractSubmit')?.textContent || '6';
        if (supplierTodo6) supplierTodo6.textContent = document.getElementById('settlementInvoice')?.textContent || '8';
      } else {
        // 采购专员：从现有模块同步数据
        const buyerTodo1 = document.getElementById('buyerTodo1'); // 待我审核采购单
        const buyerTodo2 = document.getElementById('buyerTodo2'); // 待收货
        const buyerTodo3 = document.getElementById('buyerTodo3'); // 待退货
        const buyerTodo4 = document.getElementById('buyerTodo4'); // 待审核合同
        const buyerTodo5 = document.getElementById('buyerTodo5'); // 待付款
        
        // 同步数据（从现有模块获取）
        if (buyerTodo1) buyerTodo1.textContent = document.getElementById('poMyAudit')?.textContent.split('/')[0] || '10';
        if (buyerTodo2) buyerTodo2.textContent = document.getElementById('orderReceiving')?.textContent || '15';
        if (buyerTodo3) buyerTodo3.textContent = document.getElementById('afterSaleReturn')?.textContent || '2';
        if (buyerTodo4) buyerTodo4.textContent = document.getElementById('contractApproving')?.textContent || '9';
        if (buyerTodo5) buyerTodo5.textContent = document.getElementById('settlementPayment')?.textContent || '5';
      }
    }
    
    // ========== 图表相关变量 ==========
    let lineChart = null;
    let pieChart = null;
    let lineChartType = 'total'; // 'total' 或 'increment'
    let lineChartPeriod = 'day'; // 'day', 'week', 'month'
    let pieChartPeriod = 'month'; // 'month', 'year', 'all'
    
    // ========== Mock 数据生成 ==========
    function generateLineChartData(type, period, role) {
      const data = {
        labels: [],
        datasets: []
      };
      
      // 根据周期生成标签
      if (period === 'day') {
        for (let i = 29; i >= 0; i--) {
          const date = new Date();
          date.setDate(date.getDate() - i);
          data.labels.push(`${date.getMonth() + 1}-${date.getDate()}`);
        }
      } else if (period === 'week') {
        for (let i = 11; i >= 0; i--) {
          data.labels.push(`第${12 - i}周`);
        }
      } else if (period === 'month') {
        for (let i = 11; i >= 0; i--) {
          const date = new Date();
          date.setMonth(date.getMonth() - i);
          data.labels.push(`${date.getMonth() + 1}月`);
        }
      }
      
      // 根据角色和类型生成数据
      if (role === 'supplier') {
        // 供应商：收到订单、完成订单
        let receivedTotal = 500; // 初始累计值
        let completedTotal = 400; // 初始累计值
        
        const receivedData = data.labels.map(() => {
          if (type === 'total') {
            // 总量：累计递增
            receivedTotal += Math.floor(Math.random() * 20) + 10;
            return receivedTotal;
          } else {
            // 增量：每期新增
            return Math.floor(Math.random() * 30) + 10;
          }
        });
        
        const completedData = data.labels.map(() => {
          if (type === 'total') {
            // 总量：累计递增（完成数略少于收到数）
            completedTotal += Math.floor(Math.random() * 15) + 8;
            return completedTotal;
          } else {
            // 增量：每期新增
            return Math.floor(Math.random() * 25) + 5;
          }
        });
        
        data.datasets = [
          {
            label: '收到订单',
            data: receivedData,
            borderColor: '#3b82f6',
            backgroundColor: 'rgba(59, 130, 246, 0.1)',
            tension: 0.4,
            fill: true
          },
          {
            label: '完成订单',
            data: completedData,
            borderColor: '#10b981',
            backgroundColor: 'rgba(16, 185, 129, 0.1)',
            tension: 0.4,
            fill: true
          }
        ];
      } else {
        // 采购专员：发起订单、完成订单
        let initiatedTotal = 500; // 初始累计值
        let completedTotal = 400; // 初始累计值
        
        const initiatedData = data.labels.map(() => {
          if (type === 'total') {
            // 总量：累计递增
            initiatedTotal += Math.floor(Math.random() * 20) + 10;
            return initiatedTotal;
          } else {
            // 增量：每期新增
            return Math.floor(Math.random() * 30) + 10;
          }
        });
        
        const completedData = data.labels.map(() => {
          if (type === 'total') {
            // 总量：累计递增（完成数略少于发起数）
            completedTotal += Math.floor(Math.random() * 15) + 8;
            return completedTotal;
          } else {
            // 增量：每期新增
            return Math.floor(Math.random() * 25) + 5;
          }
        });
        
        data.datasets = [
          {
            label: '发起订单',
            data: initiatedData,
            borderColor: '#3b82f6',
            backgroundColor: 'rgba(59, 130, 246, 0.1)',
            tension: 0.4,
            fill: true
          },
          {
            label: '完成订单',
            data: completedData,
            borderColor: '#10b981',
            backgroundColor: 'rgba(16, 185, 129, 0.1)',
            tension: 0.4,
            fill: true
          }
        ];
      }
      
      return data;
    }
    
    function generatePieChartData(period) {
      // 根据周期生成不同的数据
      const baseData = {
        'month': [12, 28, 35, 120, 8, 15],
        'year': [95, 240, 290, 980, 65, 125],
        'all': [320, 850, 920, 3200, 220, 450]
      };
      
      const data = baseData[period] || baseData['month'];
      
      return {
        labels: ['采购审核中', '待发货', '待收货', '收货完成', '已取消', '退货中'],
        datasets: [{
          data: data,
          backgroundColor: [
            '#a855f7', // 采购审核中 - 紫色
            '#f97316', // 待发货 - 橙色
            '#10b981', // 待收货 - 绿色
            '#059669', // 收货完成 - 深绿色
            '#6b7280', // 已取消 - 灰色
            '#ef4444'  // 退货中 - 红色
          ],
          borderWidth: 2,
          borderColor: '#ffffff'
        }]
      };
    }
    
    // ========== 折线图切换函数 ==========
    function switchLineChartType(type) {
      lineChartType = type;
      
      // 更新按钮状态
      document.getElementById('lineChartTypeTotal').className = 
        type === 'total' ? 'chart-toggle-btn active' : 'chart-toggle-btn inactive';
      document.getElementById('lineChartTypeIncrement').className = 
        type === 'increment' ? 'chart-toggle-btn active' : 'chart-toggle-btn inactive';
      
      // 重新渲染图表
      renderLineChart();
    }
    
    function switchLineChartPeriod(period) {
      lineChartPeriod = period;
      
      // 更新按钮状态
      document.getElementById('lineChartPeriodDay').className = 
        period === 'day' ? 'chart-toggle-btn active' : 'chart-toggle-btn inactive';
      document.getElementById('lineChartPeriodWeek').className = 
        period === 'week' ? 'chart-toggle-btn active' : 'chart-toggle-btn inactive';
      document.getElementById('lineChartPeriodMonth').className = 
        period === 'month' ? 'chart-toggle-btn active' : 'chart-toggle-btn inactive';
      
      // 重新渲染图表
      renderLineChart();
    }
    
    // ========== 饼状图切换函数 ==========
    function switchPieChartPeriod(period) {
      pieChartPeriod = period;
      
      // 更新按钮状态
      document.getElementById('pieChartPeriodMonth').className = 
        period === 'month' ? 'chart-toggle-btn active' : 'chart-toggle-btn inactive';
      document.getElementById('pieChartPeriodYear').className = 
        period === 'year' ? 'chart-toggle-btn active' : 'chart-toggle-btn inactive';
      document.getElementById('pieChartPeriodAll').className = 
        period === 'all' ? 'chart-toggle-btn active' : 'chart-toggle-btn inactive';
      
      // 重新渲染图表
      renderPieChart();
    }
    
    // ========== 渲染折线图 ==========
    function renderLineChart() {
      const ctx = document.getElementById('lineChart');
      if (!ctx) return;
      
      const role = getCurrentRole();
      const chartData = generateLineChartData(lineChartType, lineChartPeriod, role);
      
      // 销毁旧图表
      if (lineChart) {
        lineChart.destroy();
      }
      
      // 创建新图表
      lineChart = new Chart(ctx, {
        type: 'line',
        data: chartData,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'top',
              labels: {
                usePointStyle: true,
                padding: 15,
                font: {
                  size: 12
                }
              }
            },
            tooltip: {
              mode: 'index',
              intersect: false
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                font: {
                  size: 11
                }
              },
              grid: {
                color: 'rgba(0, 0, 0, 0.05)'
              }
            },
            x: {
              ticks: {
                font: {
                  size: 11
                },
                maxRotation: 45,
                minRotation: 0
              },
              grid: {
                display: false
              }
            }
          }
        }
      });
    }
    
    // ========== 渲染饼状图 ==========
    function renderPieChart() {
      const ctx = document.getElementById('pieChart');
      if (!ctx) return;
      
      const chartData = generatePieChartData(pieChartPeriod);
      
      // 销毁旧图表
      if (pieChart) {
        pieChart.destroy();
      }
      
      // 创建新图表
      pieChart = new Chart(ctx, {
        type: 'pie',
        data: chartData,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                usePointStyle: true,
                padding: 12,
                font: {
                  size: 11
                },
                boxWidth: 12
              }
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  const label = context.label || '';
                  const value = context.parsed || 0;
                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                  const percentage = ((value / total) * 100).toFixed(1);
                  return `${label}: ${value} (${percentage}%)`;
                }
              }
            }
          }
        }
      });
    }
    
    // ========== 页面跳转（模拟） ==========
    function navigateTo(page) {
      console.log('Navigate to:', page);
      alert(`跳转到：${page}（演示中，真实环境会跳转到对应页面）`);
    }
    
    // ========== 页面加载时初始化 ==========
    document.addEventListener('DOMContentLoaded', function() {
      console.log('工作台首页加载完成');
      
      // 读取保存的角色
      const savedRole = getCurrentRole();
      const roleSelector = document.getElementById('roleSelector');
      
      if (roleSelector) {
        roleSelector.value = savedRole;
        updateRoleHint(savedRole);
        updateUserName(savedRole);
        updatePageByRole(savedRole);
      }
      
      // 初始化图表
      renderLineChart();
      renderPieChart();
    });
  </script>
  
</body>
</html>
